CREATE TABLE CHAP10HW_EMP AS SELECT * FROM EMP;
CREATE TABLE CHAP10HW_DEPT AS SELECT * FROM DEPT;
CREATE TABLE CHAP10HW_SALGRADE AS SELECT * FROM SALGRADE;
SELECT * FROM TAB;
DROP TABLE CHAP10HW_EMP;
DROP TABLE CHAP10HW_DEPT;

--Q1


INSERT INTO CHAP10HW_DEPT (DEPTNO, DNAME, LOC)
VALUES (50,'ORACLE','BUSAN');

INSERT INTO CHAP10HW_DEPT (DEPTNO, DNAME, LOC)
VALUES (60,'SQL','ILSAN');

INSERT INTO CHAP10HW_DEPT (DEPTNO, DNAME, LOC)
VALUES (70,'SELECT','INCHEON');

INSERT INTO CHAP10HW_DEPT (DEPTNO, DNAME, LOC)
VALUES (80,'DML','BUSAN');

SELECT * FROM CHAP10HW_DEPT;

--Q2

INSERT INTO CHAP10HW_EMP
VALUES (7201,'TEST_USER1','MANAGER',7788,'2016/01/02',4500,null,50);

INSERT INTO CHAP10HW_EMP
VALUES (7202,'TEST_USER2','CLERK',7201,'2016/02/21',1800,null,50);

INSERT INTO CHAP10HW_EMP
VALUES (7203,'TEST_USER3','ANALYST',7201,'2016/04/11',3400,null,60);

INSERT INTO CHAP10HW_EMP
VALUES (7204,'TEST_USER4','SALESMAN',7201,'2016/05/31',2700,300,60);

INSERT INTO CHAP10HW_EMP
VALUES (7205,'TEST_USER5','CLERK',7201,'2016/07/20',2600,null,70);

INSERT INTO CHAP10HW_EMP
VALUES (7206,'TEST_USER6','CLERK',7201,'2016/09/08',2600,null,70);

INSERT INTO CHAP10HW_EMP
VALUES (7207,'TEST_USER7','LECTURER',7201,'2016/10/28',2300,null,80);

INSERT INTO CHAP10HW_EMP
VALUES (7208,'TEST_USER8','STUDENT',7201,'2018/03/09',1200,null,80);

SELECT * FROM CHAP10HW_EMP;

--Q3

UPDATE CHAP10HW_EMP
SET DEPTNO = '70'
WHERE SAL > (SELECT AVG(SAL) FROM CHAP10HW_EMP WHERE DEPTNO = 50 );


--Q4

UPDATE CHAP10HW_EMP
SET DEPTNO = 80,
    SAL = SAL + (SAL / 10)
WHERE     HIREDATE >
      (SELECT MIN(HIREDATE)
      FROM CHAP10HW_EMP
      WHERE DEPTNO =60);

--Q5

DELETE FROM CHAP10HW_EMP
WHERE EMPNO in (SELECT E.EMPNO
                FROM CHAP10HW_EMP E join SALGRADE S
                on (E.SAL BETWEEN S.LOSAL and S.HISAL)
                WHERE S.GRADE = 5);

SELECT * FROM SALGRADE;
SELECT * FROM CHAP10HW_EMP;

